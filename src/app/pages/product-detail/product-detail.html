<div class="product-detail" *ngIf="product">
  <div class="container">
    <!-- Back Button -->
    <button class="back-btn" (click)="goBack()">
      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="m15 18-6-6 6-6"></path>
      </svg>
      Back to Products
    </button>

    <div class="product-content">
      <!-- Product Images -->
      <div class="product-images">
        <div class="main-image">
          <img [src]="selectedImage" [alt]="product.name" class="product-main-img">
        </div>
        <div class="thumbnail-images" *ngIf="product.images.length > 1">
          <img 
            *ngFor="let image of product.images" 
            [src]="image" 
            [alt]="product.name"
            [class.active]="selectedImage === image"
            (click)="selectImage(image)"
            class="thumbnail-img">
        </div>
      </div>

      <!-- Product Info -->
      <div class="product-info">
        <div class="product-badges">
          <span *ngIf="product.isNew" class="badge badge-new">New</span>
          <span *ngIf="product.isOnSale" class="badge badge-sale">Sale</span>
          <span *ngIf="product.discount" class="badge badge-discount">-{{ product.discount }}%</span>
        </div>

        <h1 class="product-title">{{ product.name }}</h1>
        <div class="product-brand">{{ product.brand }}</div>
        
        <!-- Rating -->
        <div class="product-rating">
          <div class="stars">
            <span *ngFor="let star of [1,2,3,4,5]" 
                  class="star" 
                  [class.filled]="star <= product.rating">
              ★
            </span>
          </div>
          <span class="rating-text">({{ product.reviewCount }} reviews)</span>
        </div>

        <!-- Price -->
        <div class="product-price">
          <span class="current-price">${{ product.price.toFixed(2) }}</span>
          <span *ngIf="product.originalPrice" class="original-price">${{ product.originalPrice.toFixed(2) }}</span>
        </div>

        <!-- Description -->
        <div class="product-description">
          <p>{{ product.description }}</p>
        </div>

        <!-- Size Selection -->
        <div class="product-options" *ngIf="product.sizes.length > 0">
          <label class="option-label">Size:</label>
          <div class="size-options">
            <button 
              *ngFor="let size of product.sizes"
              [class.selected]="selectedSize === size"
              (click)="selectSize(size)"
              class="size-btn">
              {{ size }}
            </button>
          </div>
        </div>

        <!-- Color Selection -->
        <div class="product-options" *ngIf="product.colors.length > 0">
          <label class="option-label">Color:</label>
          <div class="color-options">
            <button 
              *ngFor="let color of product.colors"
              [class.selected]="selectedColor === color"
              (click)="selectColor(color)"
              class="color-btn">
              {{ color }}
            </button>
          </div>
        </div>

        <!-- Quantity -->
        <div class="product-options">
          <label class="option-label">Quantity:</label>
          <div class="quantity-selector">
            <button (click)="decreaseQuantity()" class="qty-btn">-</button>
            <input type="number" [(ngModel)]="quantity" min="1" class="qty-input">
            <button (click)="increaseQuantity()" class="qty-btn">+</button>
          </div>
        </div>

        <!-- Add to Cart -->
        <div class="product-actions">
          <button 
            class="add-to-cart-btn"
            (click)="onAddToCart()"
            [disabled]="!product.inStock || !selectedSize || !selectedColor">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="9" cy="21" r="1"></circle>
              <circle cx="20" cy="21" r="1"></circle>
              <path d="m1 1 4 4 13 1 2 8H7l-2-4H1"></path>
            </svg>
            {{ product.inStock ? 'Add to Cart' : 'Out of Stock' }}
          </button>
          
          <button class="wishlist-btn">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path>
            </svg>
            Add to Wishlist
          </button>
        </div>

        <!-- Product Details -->
        <div class="product-details">
          <h3>Product Details</h3>
          <ul>
            <li><strong>Category:</strong> {{ product.category }}</li>
            <li><strong>Brand:</strong> {{ product.brand }}</li>
            <li><strong>Available Sizes:</strong> {{ product.sizes.join(', ') }}</li>
            <li><strong>Available Colors:</strong> {{ product.colors.join(', ') }}</li>
            <li><strong>Stock Status:</strong> {{ product.inStock ? 'In Stock' : 'Out of Stock' }}</li>
          </ul>
        </div>
      </div>
    </div>

    <!-- Reviews Section -->
    <div class="reviews-section">
      <div class="reviews-header">
        <h2>Customer Reviews</h2>
        <button class="toggle-reviews-btn" (click)="toggleReviews()">
          {{ showReviews ? 'Hide Reviews' : 'Show Reviews' }}
        </button>
      </div>

      <div class="reviews-content" *ngIf="showReviews">
        <div class="reviews-summary">
          <div class="rating-overview">
            <div class="average-rating">{{ product.rating }}</div>
            <div class="stars-large">
              <span *ngFor="let star of [1,2,3,4,5]" 
                    class="star" 
                    [class.filled]="star <= product.rating">
                ★
              </span>
            </div>
            <div class="rating-count">Based on {{ product.reviewCount }} reviews</div>
          </div>
        </div>

        <div class="reviews-list" *ngIf="reviews.length > 0">
          <div *ngFor="let review of reviews" class="review-item">
            <div class="review-header">
              <div class="reviewer-info">
                <strong>{{ review.userName }}</strong>
                <span class="verified-badge" *ngIf="review.verified">✓ Verified Purchase</span>
              </div>
              <div class="review-rating">
                <span *ngFor="let star of [1,2,3,4,5]" 
                      class="star" 
                      [class.filled]="star <= review.rating">
                  ★
                </span>
              </div>
            </div>
            <div class="review-content">
              <p>{{ review.comment }}</p>
            </div>
            <div class="review-date">{{ review.date | date:'mediumDate' }}</div>
          </div>
        </div>

        <div class="no-reviews" *ngIf="reviews.length === 0">
          <p>No reviews yet. Be the first to review this product!</p>
        </div>
      </div>
    </div>
  </div>
</div>

<div class="product-not-found" *ngIf="!product">
  <div class="container">
    <div class="not-found-content">
      <h1>Product Not Found</h1>
      <p>The product you're looking for doesn't exist.</p>
      <button class="btn btn-primary" (click)="goBack()">Back to Products</button>
    </div>
  </div>
</div>
